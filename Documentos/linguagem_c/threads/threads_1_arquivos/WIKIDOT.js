var WIKIDOT={};var WIKIDOT={page:function(){},modules:function(){},utils:function(){},vars:function(){}};WIKIDOT.utils={changeTextareaRowNo:function(A,C){var B=$(A);if((C<0&&B.rows+C>=5)||(C>0&&B.rows+C<=50)){B.rows=B.rows+C}}};WIKIDOT.visuals={showCenterMessage:function(B){var A=document.getElementsByTagName("body").item(0);sDiv=document.createElement("div");sDiv.id="center-message-shader";bodyHeigh=A.offsetHeight+50;viewportHeight=YAHOO.util.Dom.getClientHeight();height=Math.max(bodyHeigh,viewportHeight);sDiv.style.height=height+"px";mTable=document.createElement("table");mTable.id="center-message-wrapper";mRow=document.createElement("tr");mTd=document.createElement("td");mRow.appendChild(mTd);mTable.appendChild(mRow);mDiv=document.createElement("div");mDiv.id="center-message";mTd.appendChild(mDiv);mDiv.innerHTML=B;sDiv.style.visibility="hidden";mTable.style.visibility="hidden";A.appendChild(sDiv);A.appendChild(mTable);YAHOO.util.Dom.setY("center-message-wrapper",OZONE.visuals.scrollOffsetY());mTable.style.height=viewportHeight+"px";ofx=new fx.Opacity("center-message",{duration:100});ofx.setOpacity(0);sDiv.style.visibility="visible";mTable.style.visibility="visible";ofx.custom(0,1)},changeCenterMessage:function(A){ofx=new fx.Opacity("center-message",{duration:100});ofx.custom(1,0);setTimeout('OZONE.utils.setInnerHTMLContent("center-message", "'+A+'");ofx.custom(0,1)',200)},hideCenterMessage:function(){var A=document.getElementsByTagName("body").item(0);sDiv=document.getElementById("center-message-shader");mTable=document.getElementById("center-message-wrapper");if(sDiv!=null){A.removeChild(sDiv);A.removeChild(mTable)}}};WIKIDOT.utils.formatDates=function(C){if(C==null){var E=document.getElementsByTagName("odate")}else{var B=$(C);var E=B.getElementsByTagName("odate")}for(i=0;i<E.length;i++){var D=E[i].innerHTML;var A=new Date();A.setTime(D*1000);var F=A.toLocaleString();E[i].innerHTML=F}};WIKIDOT.utils.handleError=function(B){if(B.status!="ok"){var A=new OZONE.dialogs.ErrorDialog();if(B.status=="no_permission"){A.title=ogettext("Permission error")}A.content="<h1>"+ogettext("Oooops!")+"</h1><p>"+B.message+"</p>";A.show();return false}else{return true}};WIKIDOT.render={};WIKIDOT.render.printuser=function(B,F,E){var D='href="javascript:;" onclick="WIKIDOT.page.listeners.userInfo('+B+')"';var A='<span class="printuser">';var C=window.location.protocol;if(E==true){A+="<a "+D+' ><!--[if gte IE 7]><!--><img class="small" src="/common--images/avatars/'+Math.floor(B/1000)+"/"+B+'/a16.png" alt="" style="background-image:url('+C+"//www.wikidot.com/userkarma.php?u="+B+')"/><!--<![endif]-->';A+='<!--[if lt IE 7]><img class="small" src="/common&#45;&#45;images/avatars/'+Math.floor(B/1000)+"/"+B+'/a16.png" alt="" style="filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='+C+"//www.wikidot.com/userkarma.php?u="+B+",sizingMethod='scale')\"/><![endif]-->"}A+="<a "+D+">"+F+"</a></span>";return A};WIKIDOT.render.fixAvatarHover=function(B){var D=YAHOO.util.Dom.getElementsByClassName("printuser avatarhover","span",B);for(var C=0;C<D.length;C++){var A=D[C].getElementsByTagName("a")[0];if(!A){A=D[C].getElementsByTagName("img")[0]}if(A.getElementsByTagName("img").length==1){YAHOO.util.Event.addListener(A,"mouseover",WIKIDOT.render.fixAvatarHover.showHover)}}};WIKIDOT.render.fixAvatarHover.showHover=function(I){if($("avatar-hover-container")==null){var N=document.createElement("div");N.style.visibility="hidden";N.style.position="absolute";N.style.width="100%";document.getElementsByTagName("body")[0].appendChild(N)}else{N=$("avatar-hover-container")}if(this.hoverAvatar==null){var F=this.getElementsByTagName("img")[0];var M=F.src.replace(/a16\.png/,"a48.png");M=M.replace(/16$/,"48");var K=document.createElement("a");var G=document.createElement("img");G.src=M;K.className="avatar-hover";K.style.position="absolute";K.style.display="none";K.href=this.href;K.onclick=this.onclick;var J=document.createElement("div");J.appendChild(G);K.appendChild(J);YAHOO.util.Dom.generateId(K);this.hoverAvatar=K;N.appendChild(K);YAHOO.util.Event.addListener(K,"mouseout",WIKIDOT.render.fixAvatarHover.hideHover);YAHOO.util.Event.addListener(K,"mousemove",WIKIDOT.render.fixAvatarHover.mousemove);var A=new fx.Opacity(K,{duration:200});this.hoverAvatarEffect=A;A.setOpacity(0)}var H=this.hoverAvatar;var E,D;E=YAHOO.util.Dom.getX(this)+8+8;D=YAHOO.util.Dom.getY(this)+8;H.style.display="block";var G=H.getElementsByTagName("img")[0];var L,C;var B=false;if(G.height==0){L=48;C=48;B=true;YAHOO.util.Event.addListener(G,"load",function(Q,O){var P=this;YAHOO.util.Dom.setXY(O,[E-(P.width/2+8),D-(P.height/2+8)])},H)}else{L=G.height;C=G.width}YAHOO.util.Dom.setXY(H,[E-(C/2+8),D-(L/2+8)]);if(H.style.opacity==0){this.hoverAvatarEffect.custom(0,1)}H.lastAccess=(new Date()).getTime();setTimeout('WIKIDOT.render.fixAvatarHover.mousemove.autoHide("'+H.id+'")',1000)};WIKIDOT.render.fixAvatarHover.hideHover=function(B){var A=YAHOO.util.Event.getRelatedTarget(B);if(!YAHOO.util.Dom.isAncestor(this,A)&&A!=this){this.style.display="none";this.style.visibility="hidden";this.style.opacity=0}};WIKIDOT.render.fixAvatarHover.mousemove=function(A){this.lastAccess=(new Date()).getTime()};WIKIDOT.render.fixAvatarHover.mousemove.autoHide=function(C){var A=$(C);var B=(new Date()).getTime();if(A.lastAccess+3000<B){A.style.display="none";A.style.visibility="hidden";A.style.opacity=0}else{setTimeout('WIKIDOT.render.fixAvatarHover.mousemove.autoHide("'+A.id+'")',1000)}};WIKIDOT.page.vars={};WIKIDOT.page.vars.forceLockFlag=false;WIKIDOT.page.listeners={editClick:function(E){var B=WIKIREQUEST.info.pageId;if($("np-text")){if($("np-text").value!=""){var A=new OZONE.dialogs.ErrorDialog();A.content='You have an active editor somewhere already and it is not possible to edit multiple elements at once.<br/><br/>(<a href="javascript:;" onclick="OZONE.visuals.scrollTo(\''+WIKIDOT.Editor.editElementId+"');OZONE.dialog.cleanAll()\">scroll to active editor</a>)";A.show();return }else{var C=$("new-post-form-container");C.parentNode.removeChild(C);if($("new-post-button")){$("new-post-button").style.display=""}WIKIDOT.Editor.shutDown()}}if(B!=null){var D=new Object();D.page_id=B;D.mode="page";D.wiki_page=WIKIREQUEST.info.requestPageName}else{WIKIDOT.page.vars.newPage=true;var D=new Object();D.mode="page";D.wiki_page=WIKIREQUEST.info.requestPageName}if(WIKIDOT.page.vars.forceLockFlag==true){WIKIDOT.page.vars.forceLockFlag=false;D.force_lock="yes"}OZONE.ajax.requestModule("edit/PageEditModule",D,WIKIDOT.page.callbacks.editClick)},append:function(B){var A=new Object();A.page_id=WIKIREQUEST.info.pageId;A.mode="append";OZONE.ajax.requestModule("edit/PageEditModule",A,WIKIDOT.page.callbacks.editClick)},editSection:function(C){var A=this.id.replace(/edit\-section\-b\-/,"");var B=new Object();B.page_id=WIKIREQUEST.info.pageId;B.mode="section";B.section=A;OZONE.ajax.requestModule("edit/PageEditModule",B,WIKIDOT.page.callbacks.editClick)},historyClick:function(B){var A=new Object();A.page_id=WIKIREQUEST.info.pageId;OZONE.ajax.requestModule("history/PageHistoryModule",A,WIKIDOT.page.callbacks.historyClick)},filesClick:function(B){var A=new Object();A.page_id=WIKIREQUEST.info.pageId;OZONE.ajax.requestModule("files/PageFilesModule",A,WIKIDOT.page.callbacks.filesClick)},blockClick:function(B){var A=new Object();A.page_id=WIKIREQUEST.info.pageId;OZONE.ajax.requestModule("pageblock/PageBlockModule",A,WIKIDOT.page.callbacks.blockClick)},moreOptionsClick:function(B){if(!$("page-options-bottom")){return }var A=new fx.Opacity("page-options-bottom-2",{duration:200});A.setOpacity(0);$("page-options-bottom-2").style.display="block";A.custom(0,1);$("more-options-button").innerHTML=$("more-options-button").innerHTML.replace(/\+/,"-");YAHOO.util.Event.removeListener("more-options-button","click",WIKIDOT.page.listeners.moreOptionsClick);YAHOO.util.Event.addListener("more-options-button","click",WIKIDOT.page.listeners.lessOptionsClick);OZONE.visuals.scrollTo("page-options-bottom")},lessOptionsClick:function(B){if(!$("page-options-bottom-2")){return }var A=new fx.Opacity("page-options-bottom-2",{duration:200});A.custom(1,0);setTimeout('document.getElementById("page-options-bottom-2").style.display="none"',200);$("more-options-button").innerHTML=$("more-options-button").innerHTML.replace(/\-/,"+");YAHOO.util.Event.removeListener("more-options-button","click",WIKIDOT.page.listeners.lessOptionsClick);YAHOO.util.Event.addListener("more-options-button","click",WIKIDOT.page.listeners.moreOptionsClick)},logoutClick:function(B){var A=new Object();A.action="LoginAction";A.event="logout";OZONE.ajax.requestModule(null,A,WIKIDOT.page.callbacks.logoutClick)},loginClick2:function(F,E){var D=OZONE.dialog.factory.shader();D.show();var A=document.getElementsByTagName("body").item(0);var B=document.createElement("iframe");B.id="login-iframe";var C=window.location.protocol+"//www.wikidot.com/default--flow/login__LoginIframeScreen";C+="/siteId/"+WIKIREQUEST.info.siteId;C+="/categoryId/"+WIKIREQUEST.info.categoryId;C+="/themeId/"+WIKIREQUEST.info.themeId;C+="/url/"+encodeURIComponent(encodeURIComponent(window.location.href));B.src=C;B.scrolling="no";B.frameBorder=0;B.style.height=YAHOO.util.Dom.getClientHeight()+"px";A.appendChild(B)},loginClick:function(D,C){var A=WIKIREQUEST.info.lang;if(A=="en"){A="www"}var B="https://"+A+"."+URL_DOMAIN+"/auth:login?origUrl="+encodeURIComponent(window.location.href);setTimeout(function(){window.location.href=B},50);return },loginClick0:function(C,B){var A=new Object();if(B){A.reset="yes"}OZONE.ajax.requestModule("login/LoginModule",A,WIKIDOT.page.callbacks.loginClick)},createAccount:function(C){var A=WIKIREQUEST.info.lang;if(A=="en"){A="www"}var B="https://"+A+"."+URL_DOMAIN+"/auth:newaccount?origUrl="+encodeURIComponent(window.location.href);if(WIKIREQUEST.createAccountSkipCongrats){B+="&origUrlForce=true"}setTimeout(function(){window.location.href=B},50);return },toggleEditSections:function(J){if(WIKIDOT.page.vars.editSectionsActive==false){var K=$("page-content");var A=K.childNodes;var O=new Array();for(var G=0;G<A.length;G++){var B=A[G].tagName;if(B&&B.toLowerCase().match(/^h[1-6]$/)&&A[G].id.match(/^toc/)){O.push(A[G])}}if(O.length==0){var N=new OZONE.dialogs.ErrorDialog();N.content="There are no isolated sections to edit.";N.show();return }var M=0;var C=["h1","h2","h3","h4","h5","h6"];for(var G=0;G<C.length;G++){var H=K.getElementsByTagName(C[G]);for(var E=0;E<H.length;E++){if(H[E].id.match(/^toc/)){M++}}}if(M!=O.length){alert("It seems that headings do not have a valid structure...");return }var D=new Array();for(var G=0;G<O.length;G++){var L=document.createElement("a");L.innerHTML="edit";L.href="javascript:;";L.className="edit-section-button";L.id="edit-section-b-"+O[G].id.replace(/toc/,"");YAHOO.util.Event.addListener(L,"click",WIKIDOT.page.listeners.editSection);var F=new fx.Opacity(L,{duration:300});F.setOpacity(0);K.insertBefore(L,O[G]);F.custom(0,1);D.push(L)}WIKIDOT.page.vars.editHeadings=O;WIKIDOT.page.vars.sectionEditButtons=D;WIKIDOT.page.vars.editSectionsActive=true}else{var I=WIKIDOT.page.vars.sectionEditButtons;for(var G=0;G<I.length;G++){I[G].parentNode.removeChild(I[G])}WIKIDOT.page.vars.editSectionsActive=false;return }},editMetaClick:function(B){var A=new Object();A.pageId=WIKIREQUEST.info.pageId;OZONE.ajax.requestModule("edit/EditMetaModule",A,WIKIDOT.page.callbacks.editMeta)},editTags:function(B){var A=new Object();A.pageId=WIKIREQUEST.info.pageId;OZONE.ajax.requestModule("pagetags/PageTagsModule",A,WIKIDOT.page.callbacks.editTags)},siteTools:function(A){OZONE.ajax.requestModule("sitetools/SiteToolsModule",null,WIKIDOT.page.callbacks.siteTools)},backlinksClick:function(C){var A=WIKIREQUEST.info.pageId;var B=new Object();B.page_id=A;OZONE.ajax.requestModule("backlinks/BacklinksModule",B,WIKIDOT.page.callbacks.backlinksClick)},watchersClick:function(C){var A=WIKIREQUEST.info.pageId;var B={};B.page_id=A;B.verbose=true;OZONE.ajax.requestModule("watch/WhoWatchesModule",B,WIKIDOT.page.callbacks.backlinksClick)},viewSourceClick:function(C){var A=WIKIREQUEST.info.pageId;var B=new Object();B.page_id=A;OZONE.ajax.requestModule("viewsource/ViewSourceModule",B,WIKIDOT.page.callbacks.viewSourceClick)},closeActionArea:function(C){var A=$("action-area");if(A){if(("page-options-bottom")){var B=new fx.ScrollBottom({duration:100,transition:fx.sineOut});B.scrollTo("page-options-bottom")}setTimeout('$("action-area").innerHTML = "";$("action-area").style.display = "none"',200)}},userInfo:function(A){var B=new Object();B.user_id=A;OZONE.ajax.requestModule("users/UserInfoWinModule",B,WIKIDOT.page.callbacks.userInfo)},anonymousUserInfo:function(A){var B=new Object();B.userString=A;OZONE.ajax.requestModule("users/AnonymousInfoWinModule",B,WIKIDOT.page.callbacks.userInfo)},renamePage:function(B){var A=new Object();A.pageId=WIKIREQUEST.info.pageId;OZONE.ajax.requestModule("rename/RenamePageModule",A,WIKIDOT.page.callbacks.renamePage)},deletePage:function(B){var A=new Object();A.pageId=WIKIREQUEST.info.pageId;A["delete"]="yes";OZONE.ajax.requestModule("rename/RenamePageModule",A,WIKIDOT.page.callbacks.renamePage)},createPageDiscussion:function(B){var A=new Object();A.page_id=WIKIREQUEST.info.pageId;A.action="ForumAction";A.event="createPageDiscussionThread";OZONE.ajax.requestModule("Empty",A,WIKIDOT.page.callbacks.createPageDiscussion)},flagPageObjectionable:function(B){var A=new Object();A.path=window.location.pathname;OZONE.ajax.requestModule("report/FlagPageModule",A,WIKIDOT.page.callbacks.flagPageObjectionable)},pageBugReport:function(A){OZONE.ajax.requestModule("report/BugReportModule",null,WIKIDOT.page.callbacks.pageBugReport)},pageRate:function(A){OZONE.ajax.requestModule("pagerate/PageRateModule",{pageId:WIKIREQUEST.info.pageId},WIKIDOT.page.callbacks.pageRate)},parentClick:function(B){var A=new Object();A.page_id=WIKIREQUEST.info.pageId;OZONE.ajax.requestModule("parent/ParentPageModule",A,WIKIDOT.page.callbacks.parentClick)},passwordRecoveryClick:function(A){OZONE.ajax.requestModule("passwordrecovery/PasswordRecoveryModule",null,WIKIDOT.page.callbacks.passwordRecovery)},foldToc:function(B){var A=new fx.Opacity($("toc-list"),{duration:200,onComplete:function(){$("toc-list").style.display="none";var C=$("toc-action-bar").getElementsByTagName("a");C[0].style.display="none";C[1].style.display=""}});A.custom(1,0)},unfoldToc:function(C){var B=new fx.Opacity($("toc-list"),{duration:200});B.setOpacity(0);$("toc-list").style.display="block";B.custom(0,1);var A=$("toc-action-bar").getElementsByTagName("a");A[1].style.display="none";A[0].style.display=""},search:function(C){var B=$("search-top-box-input").value;B=encodeURIComponent(B);var A="/search:site/q/"+B;window.location.href=A;YAHOO.util.Event.preventDefault(C)},printClick:function(B){var A="/printer--friendly/"+window.location.pathname;var C=window.open(A,"_blank","location=no,menubar=yes,titlebar=no,resizable=yes,scrollbars=yes,width="+(screen.width*0.8)+",height="+(screen.height*0.8)+",top="+(screen.height*0.1)+",left="+(screen.width*0.1));return C},toggleCollapsibleBlock:function(F,G){var C=YAHOO.util.Event.getTarget(F);var E=C.parentNode;while(E&&E.className!="collapsible-block"){E=E.parentNode}if(!E){return }var B=YAHOO.util.Dom.getElementsByClassName("collapsible-block-folded","div",E);var A=YAHOO.util.Dom.getElementsByClassName("collapsible-block-unfolded","div",E);B=B[0];A=A[0];if(G){var D=new fx.Opacity(A,{duration:200});D.setOpacity(0);B.style.display="none";A.style.display="block";D.custom(0,1)}else{var D=new fx.Opacity(B,{duration:200});D.setOpacity(0);A.style.display="none";B.style.display="block";D.custom(0,1)}},awatch:function(F,B,D,C){var E={};E.action="WatchAction";E.event="watch";E.pageId=WIKIREQUEST.info.pageId;E.type=B;E.nolayout=true;if(D){E.unsubscribe=true}var A=C;OZONE.ajax.requestModule("watch/PageWatchStatusModule",E,function(H){if(H.status=="no_permission"){OZONE.ajax.requestModule("watch/NotLoggedInModule",{},function(K){var J=new OZONE.dialogs.ActionDialog();J.content=K.body;J.show();return });return }if(!WIKIDOT.utils.handleError(H)){return }if(A){window.location.reload();return }var I=YAHOO.util.Dom.getElementsByClassName("page-watch-options");for(i=0;i<I.length;i++){var G=new fx.Opacity(I[i],{duration:300});G.setOpacity(0);I[i].innerHTML=H.body;G.custom(0,1)}})}};WIKIDOT.page.callbacks={filesClick:function(A){if(!WIKIDOT.utils.handleError(A)){return }OZONE.utils.setInnerHTMLContent("action-area",A.body);$("action-area").style.display="block";WIKIDOT.page.utils.addCloseToActionArea();setTimeout("OZONE.visuals.scrollTo('action-area')",200)},editClick:function(B){if(!WIKIDOT.utils.handleError(B)){return }if(WIKIDOT.page.vars.newPage==true){$("page-content").innerHTML=""}if(WIKIDOT.page.vars.editSectionsActive){WIKIDOT.page.listeners.toggleEditSections()}editMode=B.mode;if(B.locked==true){WIKIDOT.page.vars.locked=true;OZONE.dialog.factory.shader().show();var I=OZONE.dialog.factory.boxcontainer();I.setContent(B.body);I.showContent();return }else{WIKIDOT.page.vars.locked=false;var A=WIKIREQUEST.info.pageId;if(A!=null){if($("page-options-bottom")){$("page-options-bottom").style.display="none";$("page-options-bottom-2").style.display="none"}if($("page-options-area-bottom")){$("page-options-area-bottom").style.display="none"}}WIKIDOT.page.vars.editlock=new Object();WIKIDOT.page.vars.editlock.id=B.lock_id;WIKIDOT.page.vars.editlock.secret=B.lock_secret;WIKIDOT.page.vars.editlock.revisionId=B.page_revision_id;WIKIDOT.page.vars.editlock.timeLeft=B.timeLeft}if(editMode=="section"){if(B.section==null){alert("Section edit error. Section does not exist");return }WIKIDOT.page.vars.editlock.rangeStart=B.rangeStart;WIKIDOT.page.vars.editlock.rangeEnd=B.rangeEnd;var F="toc"+B.section;var H=$(F);var E=document.createElement("div");E.id="edit-section-content";var D=$("page-content");D.insertBefore(E,H);var G=new RegExp("^h[1-"+H.tagName.replace(/h/i,"")+"]","i");var C=H.nextSibling;E.appendChild(H);while(C!=null){if(C.tagName&&C.tagName.match(G)&&C.id.match(/^toc/)){break}ns0=C;C=C.nextSibling;E.appendChild(ns0)}if(C){D.insertBefore($("action-area"),C)}else{D.appendChild($("action-area"))}}OZONE.utils.setInnerHTMLContent("action-area",B.body);$("action-area").style.display="block";setTimeout("OZONE.visuals.scrollTo('action-area')",200);WIKIDOT.page.vars.ctrle.disable()},historyClick:function(A){if(!WIKIDOT.utils.handleError(A)){return }OZONE.utils.setInnerHTMLContent("action-area",A.body);$("action-area").style.display="block";WIKIDOT.page.utils.addCloseToActionArea()},logoutClick:function(A){if(!WIKIDOT.utils.handleError(A)){return }window.location.reload()},loginClick:function(B){if(!WIKIDOT.utils.handleError(B)){return }WIKIDOT.vars.rsakey=B.key;WIKIDOT.vars.loginSeed=B.seed;var A=new OZONE.dialogs.Dialog();A.content=B.body;A.show()},passwordRecovery:function(B){if(!WIKIDOT.utils.handleError(B)){return }WIKIDOT.vars.rsakey=B.key;WIKIDOT.vars.loginSeed=B.seed;var A=new OZONE.dialogs.Dialog();A.content=B.body;A.show()},createAccount:function(B){if(!WIKIDOT.utils.handleError(B)){return }var A=new OZONE.dialogs.Dialog();A.content=B.body;A.show()},backlinksClick:function(A){if(!WIKIDOT.utils.handleError(A)){return }OZONE.utils.setInnerHTMLContent("action-area",A.body);$("action-area").style.display="block";WIKIDOT.page.utils.addCloseToActionArea();setTimeout("OZONE.visuals.scrollTo('action-area')",300)},viewSourceClick:function(A){if(!WIKIDOT.utils.handleError(A)){return }OZONE.utils.setInnerHTMLContent("action-area",A.body);$("action-area").style.display="block";WIKIDOT.page.utils.addCloseToActionArea();setTimeout("OZONE.visuals.scrollTo('action-area')",300)},userInfo:function(B){if(!WIKIDOT.utils.handleError(B)){return }var A=new OZONE.dialogs.Dialog();A.content=B.body;A.clickOutsideToClose=true;A.show()},renamePage:function(A){if(!WIKIDOT.utils.handleError(A)){return }$("action-area").innerHTML=A.body;$("action-area").style.display="block";WIKIDOT.page.utils.addCloseToActionArea();setTimeout("OZONE.visuals.scrollTo('action-area')",300)},editTags:function(A){if(!WIKIDOT.utils.handleError(A)){return }$("action-area").innerHTML=A.body;$("action-area").style.display="block";WIKIDOT.page.utils.addCloseToActionArea();setTimeout("OZONE.visuals.scrollTo('action-area')",300)},editMeta:function(A){if(!WIKIDOT.utils.handleError(A)){return }$("action-area").innerHTML=A.body;$("action-area").style.display="block";WIKIDOT.page.utils.addCloseToActionArea();setTimeout("OZONE.visuals.scrollTo('action-area')",300)},blockClick:function(A){if(!WIKIDOT.utils.handleError(A)){return }$("action-area").innerHTML=A.body;$("action-area").style.display="block";WIKIDOT.page.utils.addCloseToActionArea();setTimeout("OZONE.visuals.scrollTo('action-area')",300)},pageRate:function(A){if(!WIKIDOT.utils.handleError(A)){return }$("action-area").innerHTML=A.body.replace(/prw54353/,"prw54354");$("action-area").style.display="block";WIKIDOT.page.utils.addCloseToActionArea();setTimeout("OZONE.visuals.scrollTo('action-area')",300)},siteTools:function(A){if(!WIKIDOT.utils.handleError(A)){return }$("action-area").innerHTML=A.body;$("action-area").style.display="block";WIKIDOT.page.utils.addCloseToActionArea();OZONE.dialog.hovertip.dominit("site-tools-box",{delay:700,valign:"center"});setTimeout("OZONE.visuals.scrollTo('action-area')",300)},parentClick:function(A){if(!WIKIDOT.utils.handleError(A)){return }$("action-area").innerHTML=A.body;$("action-area").style.display="block";WIKIDOT.page.utils.addCloseToActionArea();setTimeout("OZONE.visuals.scrollTo('action-area')",300)},createPageDiscussion:function(B){if(!WIKIDOT.utils.handleError(B)){return }var A="/forum/t-"+B.thread_id+"/"+B.thread_unix_title;window.location.href=A},flagPageObjectionable:function(B){if(!WIKIDOT.utils.handleError(B)){return }var A=new OZONE.dialogs.Dialog();A.content=B.body;A.show()},pageBugReport:function(B){if(!WIKIDOT.utils.handleError(B)){return }var A=new OZONE.dialogs.Dialog();A.content=B.body;A.show()}};WIKIDOT.page.utils={scrollToReference:function(A){OZONE.visuals.scrollTo(A,{blink:true})},addCloseToActionArea:function(){var A=document.createElement("a");A.innerHTML="close";A.href="javascript:;";A.className="action-area-close";var B=$("action-area");if(B.firstChild){B.insertBefore(A,B.firstChild)}else{B.appendChild(A)}YAHOO.util.Event.addListener(A,"click",WIKIDOT.page.listeners.closeActionArea)},openHelpPop:function(A){var B=window.open("http://test.wikidot.com/default--screen/HelpPop/topic/"+A,"_blank","location=no,menubar=no,titlebar=no,resizable=yes,scrollbars=yes,width="+(screen.width*0.8)+",height="+(screen.height*0.8)+",top="+(screen.height*0.1)+",left="+(screen.width*0.1));return B}};WIKIDOT.page.fixers={fixMathRef:function(){var B=YAHOO.util.Dom.getElementsByClassName("eref");var G,A,D;if(B&&B.length>0){for(var C=0;C<B.length;C++){A=B[C];G=A.innerHTML;D=$("equation-"+G);if(D){var E=D.getElementsByTagName("img").item(0).cloneNode(true);var F="<b>Equation ("+G+')</b><br/><img style="margin: 1em" src="'+E.src+'"/><br/><span style="font-size: 90%">(click to scroll to the equation)</span>';OZONE.dialog.hovertip.makeTip(A,{text:F,valign:"center",style:{width:"auto",backgroundColor:"white"}})}}}},fixFootnoteRef:function(A){var F=YAHOO.util.Dom.getElementsByClassName("footnoteref","a",A);for(var B=0;B<F.length;B++){var D=F[B];var H=D.id.replace(/^footnoteref\-/,"");var G=$("footnote-"+H);var C=G.innerHTML.replace(/<a.*?<\/a>\. /,"");var E="<b>Footnote "+H+'.</b><br/><div style="margin: 0.5em 0">'+C+'</div><span style="font-size: 90%">(click to scroll to footnotes)</span>';OZONE.dialog.hovertip.makeTip(D,{text:E,valign:"center",smartWidthLimit:0.7,style:{width:"auto",backgroundColor:"white"}})}},fixBibRef:function(A){var D=YAHOO.util.Dom.getElementsByClassName("bibcite","a",A);for(var B=0;B<D.length;B++){var G=D[B];var H=G.id.replace(/bibcite\-/,"");H=H.replace(/\-[0-9]+a$/,"");var E=$("bibitem-"+H);var C=E.innerHTML.replace(/^\s*[0-9]+\.\s*/,"");var F="<b>Reference "+H.replace(/^([0-9]+\-)/,"")+'.</b><br/><div style="margin: 0.5em 0">'+C+'</div><span style="font-size: 90%">(click to scroll to bibliography)</span>';OZONE.dialog.hovertip.makeTip(G,{text:F,valign:"center",smartWidthLimit:0.7,style:{width:"auto",backgroundColor:"white"}})}},fixDates:function(){OZONE.utils.formatDates()},fixMenu:function(A){var D=$(A);if(D==null){return }var C=D.getElementsByTagName("li");for(var B=0;B<C.length;B++){YAHOO.util.Event.addListener(C[B],"mouseover",function(E){YAHOO.util.Dom.addClass(this,"sfhover")});YAHOO.util.Event.addListener(C[B],"mouseout",function(E){YAHOO.util.Dom.removeClass(this,"sfhover")})}},fixEmails:function(H){var D=YAHOO.util.Dom.getElementsByClassName("wiki-email","span",H);var B;for(var F=0;F<D.length;F++){B=D[F];if(B.innerHTML.match(/^([a-z0-9\-\.\|_])+#/i)){var K=B.innerHTML.split("#");var G=K[0].replace("|","@");var C="";for(var E=G.length-1;E>=0;E--){C+=G.charAt(E)}var J=K[1].replace("|","@");var A="";for(var E=J.length-1;E>=0;E--){A+=J.charAt(E)}var I=document.createElement("a");I.href="mailto:"+C;I.innerHTML=A;B.innerHTML="";B.appendChild(I);B.style.visibility="visible"}}},fixFoldableMenus:function(L){var A=$(L);if(!A){return }var K=YAHOO.util.Dom.getElementsByClassName("foldable-list-container","div",A);for(var H=0;H<K.length;H++){var N=K[H].getElementsByTagName("ul");for(var F=0;F<N.length;F++){var J=N[F];var G=J.parentNode;var E=true;while(G&&!YAHOO.util.Dom.hasClass(G,"foldable-list-container")){if(G.tagName&&G.tagName.toLowerCase()=="li"){E=false;break}G=G.parentNode}if(!E){J.originalDisplay=J.style.display;J.style.display="none";YAHOO.util.Dom.addClass(G,"folded");G.eff=new fx.Opacity(J,{duration:300});var C=G.childNodes[0];if(C.tagName!="A"){var M=document.createElement("a");G.insertBefore(M,C);M.appendChild(C);M.href="javascript:;"}}}var D=K[H].getElementsByTagName("a");var I=window.location.pathname;for(var F=0;F<D.length;F++){var B=D[F].href.replace(/^[a-z]*:\/\/[^\/]+\/([^\/]+).*/,"/$1");if(B==I){var G=D[F].parentNode;while(G&&!YAHOO.util.Dom.hasClass(G,"foldable-list-container")){if(G.tagName=="LI"&&YAHOO.util.Dom.hasClass(G,"folded")){YAHOO.util.Dom.replaceClass(G,"folded","unfolded");var J=G.getElementsByTagName("ul")[0];J.style.display=J.originalDisplay}G=G.parentNode}}}YAHOO.util.Event.addListener(K[H],"click",WIKIDOT.page.fixers._foldableMenuToggle)}},_foldableMenuToggle:function(C){var A;A=YAHOO.util.Event.getTarget(C,true);if(A.tagName=="A"&&A.href!="#"&&A.href!="javascript:;"){return }while(!A.tagName||A.tagName.toLowerCase()!="li"){A=A.parentNode}if(!(YAHOO.util.Dom.hasClass(A,"folded")||YAHOO.util.Dom.hasClass(A,"unfolded"))){return }if(YAHOO.util.Dom.hasClass(A,"folded")){YAHOO.util.Dom.replaceClass(A,"folded","unfolded");var B=A.getElementsByTagName("ul")[0];A.eff.setOpacity(0);B.style.display=B.originalDisplay;A.eff.custom(0,1)}else{YAHOO.util.Dom.replaceClass(A,"unfolded","folded");var B=A.getElementsByTagName("ul")[0];B.style.display="none"}},fixMenuList:function(A){A=$(A);if(!A){return }var C=A.getElementsByTagName("li");for(var D=0;D<C.length;D++){var E=C[D].childNodes[0];if(E.tagName!="A"&&E.nodeType==3&&E.innerHTML!=""){var B=document.createElement("a");C[D].insertBefore(B,E);B.appendChild(E);B.href="javascript:;"}}}};WIKIDOT.page.vars={editSectionsActive:false};WIKIDOT.page.account={};WIKIDOT.page.account.shower=function(B){var A=$("account-options");if(!A.eff){A.eff=new fx.Opacity(A,{duration:200})}A.eff.setOpacity(0);A.style.display="block";A.eff.custom(0,1)};WIKIDOT.page.account.closer=function(D){var B=$("account-options");var A=YAHOO.util.Event.getRelatedTarget(D);var C=false;if(A==B){C=true}if(A.parentNode==B){C=true}if(A.parentNode.parentNode==B){C=true}if(A.parentNode.parentNode.parentNode==B){C=true}if(C==true){return }B.eff.setOpacity(0);B.style.display="none"};WIKIDOT.page.init=function(){YAHOO.util.Event.addListener("edit-button","click",WIKIDOT.page.listeners.editClick);YAHOO.util.Event.addListener("pagerate-button","click",WIKIDOT.page.listeners.pageRate);YAHOO.util.Event.addListener("tags-button","click",WIKIDOT.page.listeners.editTags);YAHOO.util.Event.addListener("history-button","click",WIKIDOT.page.listeners.historyClick);YAHOO.util.Event.addListener("files-button","click",WIKIDOT.page.listeners.filesClick);YAHOO.util.Event.addListener("print-button","click",WIKIDOT.page.listeners.printClick);YAHOO.util.Event.addListener("site-tools-button","click",WIKIDOT.page.listeners.siteTools);YAHOO.util.Event.addListener("more-options-button","click",WIKIDOT.page.listeners.moreOptionsClick);YAHOO.util.Event.addListener("edit-append-button","click",WIKIDOT.page.listeners.append);YAHOO.util.Event.addListener("edit-sections-button","click",WIKIDOT.page.listeners.toggleEditSections);YAHOO.util.Event.addListener("edit-meta-button","click",WIKIDOT.page.listeners.editMetaClick);YAHOO.util.Event.addListener("backlinks-button","click",WIKIDOT.page.listeners.backlinksClick);YAHOO.util.Event.addListener("watchers-button","click",WIKIDOT.page.listeners.watchersClick);YAHOO.util.Event.addListener("parent-page-button","click",WIKIDOT.page.listeners.parentClick);YAHOO.util.Event.addListener("view-source-button","click",WIKIDOT.page.listeners.viewSourceClick);YAHOO.util.Event.addListener("page-block-button","click",WIKIDOT.page.listeners.blockClick);YAHOO.util.Event.addListener("rename-move-button","click",WIKIDOT.page.listeners.renamePage);YAHOO.util.Event.addListener("delete-button","click",WIKIDOT.page.listeners.deletePage);YAHOO.util.Event.addListener("search-top-box-form","submit",WIKIDOT.page.listeners.search);OZONE.dom.onDomReady(function(){OZONE.dialog.hovertip.dominit("html-body",{delay:700,valign:"center"});WIKIDOT.page.fixers.fixMenuList("top-bar");WIKIDOT.page.fixers.fixFoldableMenus("side-bar");WIKIDOT.page.fixers.fixMathRef();WIKIDOT.page.fixers.fixFootnoteRef();WIKIDOT.page.fixers.fixBibRef();WIKIDOT.page.fixers.fixDates($("html-body"));WIKIDOT.page.fixers.fixEmails($("page-content"));WIKIDOT.render.fixAvatarHover();var F=$("account-topbutton");if(F){YAHOO.util.Event.addListener(F,"mousedown",WIKIDOT.page.account.shower);YAHOO.util.Event.addListener("account-options","mouseout",WIKIDOT.page.account.closer)}WIKIDOT.page.fixers.fixMenu("top-bar");WIKIDOT.page.fixers.fixMenu("side-bar");var E=$("notifications-dialog");if(E!=null){var D=new OZONE.dialogs.Dialog();D.content=E.innerHTML;D.show();setTimeout("OZONE.dialog.factory.boxcontainer().centerContent();",1000)}var H=window.location.pathname;if(H.match(/^\/[a-z0-9\-:_]+\/edit\/true/)){WIKIDOT.page.listeners.editClick()}var G="/"+WIKIREQUEST.info.pageUnixName;var C=location.protocol+"//"+WIKIREQUEST.info.domain+G;jQuery("#top-bar, .mark-current-link").find("a[href='"+G+"'], a[href='"+C+"']").addClass("current-link")},"dummy-ondomready-block");OZONE.loc.addMessage("close window","zamknij okno","pl");OZONE.loc.addMessage("close message","zamknij wiadomość","pl");OZONE.loc.addMessage("Error","Blad","pl");OZONE.loc.addMessage("Oooops!","Ups!","pl");OZONE.loc.addMessage("Permission error","Błąd uprawnień","pl");var A={ago:"temu",day:"dzień",days:"dni",hours:"godziny",hour:"godzina",minutes:"minuty",minute:"minuta",seconds:"sekundy",second:"sekunda"};OZONE.loc.addMessages(A,"pl");var B=new YAHOO.util.KeyListener(document,{keys:69,ctrl:true},function(C,D){D=D[1];WIKIDOT.page.listeners.editClick(D);YAHOO.util.Event.stopEvent(D)});B.enable();WIKIDOT.page.vars.ctrle=B;$j(function(){if($j("#navi-bar").length>0){$j("#container-wrap").click(function(E){var C=$j(E.target);if(C.is("a")&&C.attr("href").match(/^#/)){var D=C.attr("href");D.replace(/(^#?)/,"#");if($j(D).length>0){window.setTimeout(function(){window.scrollBy(0,-30)},10)}}})}})};$j(function(){if($j("#navi-bar").length>0){if(window.location.hash){var A=window.location.hash;A.replace(/(^#?)/,"#");if($j(A).length>0){window.setTimeout(function(){window.scrollBy(0,-30)},10)}}}});WIKIDOT.page.init();var INSERT_NEWLINE="\n";var MATCH_NEWLINE="\r?\n";WIKIDOT.Editor={editElementId:null,toolbarPanelId:null,ranger:null};WIKIDOT.Editor.currentPos;WIKIDOT.Editor.init=function(D,C,B){WIKIDOT.Editor.editElementId=D;WIKIDOT.Editor.toolbarPanelId=C;WIKIDOT.Editor.ranger=new TextElementProxyUtil(D,B);YAHOO.util.Event.addListener(this.editElementId,"keypress",WIKIDOT.Editor.keyboardListener);YAHOO.util.Event.addListener(this.editElementId,"keydown",function(){WIKIDOT.Editor.lastKeyCode=null});YAHOO.util.Event.addListener(this.editElementId,"keyup",WIKIDOT.Editor.codeAssist.listener);var A;switch(OZONE.lang){case"pl":A="/common--editor/dialogs-pl.html";break;default:A="/common--editor/dialogs.html"}YAHOO.util.Connect.asyncRequest("GET",A,WIKIDOT.Editor.initCallback,null);OZONE.loc.addMessage("cancel","anuluj","pl");OZONE.loc.addMessage("insert code","wstaw kod","pl");OZONE.loc.addMessage("Image wizard","Magik wstawiania obrazu","pl");OZONE.loc.addMessage("Table wizard","Magik tabeli","pl")};WIKIDOT.Editor.shutDown=function(){YAHOO.util.Event.removeListener(this.editElementId,"keypress",WIKIDOT.Editor.keyboardListener);YAHOO.util.Event.removeListener(this.editElementId,"keyup",WIKIDOT.Editor.codeAssist.listener);WIKIDOT.Editor.ranger=null;WIKIDOT.Editor.toolbarPanelId=null;WIKIDOT.Editor.editElementId=null};WIKIDOT.Editor.initCallback={success:function(F){var E=F.responseText;var G=document.createElement("div");G.id="wd-ed-dialogs";G.innerHTML=E;G.style.display="none";var A=document.getElementsByTagName("body").item(0);A.appendChild(G);var D=$("wd-ed-toolbar");var C=$(WIKIDOT.Editor.toolbarPanelId);if(C){C.innerHTML=OZONE.utils.olang(D.innerHTML);var B=C.getElementsByTagName("a");OZONE.dialog.hovertip.makeTip(B,{style:{width:"auto"},delay:200});WIKIDOT.page.fixers.fixMenu(C)}},failure:function(A){alert("failure error code\n823468008623487666624")}};WIKIDOT.Editor.buttons={bold:function(A){WIKIDOT.Editor.utils.insertTags("**","**","bold text",WIKIDOT.Editor.utils.trimSelection)},italic:function(A){WIKIDOT.Editor.utils.insertTags("//","//","italic text",WIKIDOT.Editor.utils.trimSelection)},underline:function(A){WIKIDOT.Editor.utils.insertTags("__","__","underline text",WIKIDOT.Editor.utils.trimSelection)},strikethrough:function(A){WIKIDOT.Editor.utils.insertTags("--","--","strikethrough text",WIKIDOT.Editor.utils.trimSelection)},teletype:function(A){WIKIDOT.Editor.utils.insertTags("{{","}}","teletype text",WIKIDOT.Editor.utils.trimSelection)},superscript:function(A){WIKIDOT.Editor.utils.insertTags("^^","^^","superscript",WIKIDOT.Editor.utils.trimSelection)},subscript:function(A){WIKIDOT.Editor.utils.insertTags(",,",",,","subscript",WIKIDOT.Editor.utils.trimSelection)},raw:function(A){WIKIDOT.Editor.utils.insertTags("@@","@@","raw text",WIKIDOT.Editor.utils.trimSelection)},heading:function(C,D){var A="";for(var B=0;B<D;B++){A+="+"}WIKIDOT.Editor.utils.insertTags(A+" ","","heading level "+D,WIKIDOT.Editor.utils.trimSelection,WIKIDOT.Editor.utils.endWith2NewLine,WIKIDOT.Editor.utils.startWith2NewLine)},quote:function(A){WIKIDOT.Editor.utils.insertTags("> ","","quoted text",WIKIDOT.Editor.utils.processQuoteText,WIKIDOT.Editor.utils.endWithAtLeast1NewLine,WIKIDOT.Editor.utils.startWithAtLeast1NewLine)},hr:function(A){WIKIDOT.Editor.utils.insertText("------",WIKIDOT.Editor.utils.endWithAtLeast2NewLine,WIKIDOT.Editor.utils.startWithAtLeast2NewLine)},clearFloat:function(B,A){var C="~~~~";if(A){C+=A}WIKIDOT.Editor.utils.insertText(C,WIKIDOT.Editor.utils.endWithAtLeast2NewLine,WIKIDOT.Editor.utils.startWithAtLeast2NewLine)},toc:function(A){WIKIDOT.Editor.utils.insertText("[[toc]]",WIKIDOT.Editor.utils.endWithAtLeast1NewLine,WIKIDOT.Editor.utils.startWithAtLeast1NewLine)},uri:function(A){WIKIDOT.Editor.utils.insertTags("[http://www.example.com ","]","describe link",WIKIDOT.Editor.utils.trimSelection)},pageLink:function(A){WIKIDOT.Editor.utils.insertTags("[[[","]]]","page name",WIKIDOT.Editor.utils.trimSelection)},math:function(A){WIKIDOT.Editor.utils.insertTags("[[math]]"+INSERT_NEWLINE,INSERT_NEWLINE+"[[/math]]","insert LaTeX equation here",WIKIDOT.Editor.utils.trimSelection,WIKIDOT.Editor.utils.endWithAtLeast2NewLine,WIKIDOT.Editor.utils.startWithAtLeast2NewLine)},numberedList:function(A){WIKIDOT.Editor.utils.insertTags("# ","","list item",WIKIDOT.Editor.utils.processNumberedList,WIKIDOT.Editor.utils.endWithAtLeast1NewLine,WIKIDOT.Editor.utils.startWithAtLeast1NewLine)},bulletedList:function(A){WIKIDOT.Editor.utils.insertTags("* ","","list item",WIKIDOT.Editor.utils.processBulletedList,WIKIDOT.Editor.utils.endWithAtLeast1NewLine,WIKIDOT.Editor.utils.startWithAtLeast1NewLine)},definitionList:function(A){WIKIDOT.Editor.utils.insertTags(": "," : definition","item",WIKIDOT.Editor.utils.processBulletedList,WIKIDOT.Editor.utils.endWithAtLeast1NewLine,WIKIDOT.Editor.utils.startWithAtLeast1NewLine)},increaseListIndent:function(A){WIKIDOT.Editor.utils.insertText("",WIKIDOT.Editor.utils.increaseListIndent)},decreaseListIndent:function(A){WIKIDOT.Editor.utils.insertText("",WIKIDOT.Editor.utils.decreaseListIndent)},footnote:function(A){WIKIDOT.Editor.utils.insertTags("[[footnote]] "," [[/footnote]]","footnote text",WIKIDOT.Editor.utils.trimSelection)},inlineMath:function(A){WIKIDOT.Editor.utils.insertTags("[[$ "," $]]","insert LaTeX equation here",WIKIDOT.Editor.utils.trimSelection)},code:function(A){WIKIDOT.Editor.utils.insertTags("[[code]]"+INSERT_NEWLINE,INSERT_NEWLINE+"[[/code]]","insert the code here",WIKIDOT.Editor.utils.trimSelection,WIKIDOT.Editor.utils.endWithAtLeast2NewLine,WIKIDOT.Editor.utils.startWithAtLeast2NewLine)},video:function(A){WIKIDOT.Editor.utils.insertTags("[[embedvideo]]"+INSERT_NEWLINE,INSERT_NEWLINE+"[[/embedvideo]]","paste the html for the video here (Google Video, YouTube, Revver, Dailymotion)",WIKIDOT.Editor.utils.trimSelection,WIKIDOT.Editor.utils.endWithAtLeast2NewLine,WIKIDOT.Editor.utils.startWithAtLeast2NewLine)},audio:function(A){WIKIDOT.Editor.utils.insertTags("[[embedaudio]]"+INSERT_NEWLINE,INSERT_NEWLINE+"[[/embedaudio]]","paste the html for the audio here (odeo)",WIKIDOT.Editor.utils.trimSelection,WIKIDOT.Editor.utils.endWithAtLeast2NewLine,WIKIDOT.Editor.utils.startWithAtLeast2NewLine)},image:function(A){WIKIDOT.Editor.utils.insertTags("[[image ","]]","source",WIKIDOT.Editor.utils.trimSelection)},div:function(A){WIKIDOT.Editor.utils.insertTags("[[div]]"+INSERT_NEWLINE,INSERT_NEWLINE+"[[/div]]","block contents",WIKIDOT.Editor.utils.trimSelection,WIKIDOT.Editor.utils.endWithAtLeast2NewLine,WIKIDOT.Editor.utils.startWithAtLeast2NewLine)},bibliography:function(A){WIKIDOT.Editor.utils.insertTags("[[bibliography]]"+INSERT_NEWLINE+": "," : full source reference"+INSERT_NEWLINE+"[[/bibliography]]","label",WIKIDOT.Editor.utils.trimSelection,WIKIDOT.Editor.utils.endWithAtLeast2NewLine,WIKIDOT.Editor.utils.startWithAtLeast2NewLine)},bibliographycitation:function(A){WIKIDOT.Editor.utils.insertTags("[((bibcite ","))]","label",WIKIDOT.Editor.utils.trimSelection)},imageWizard:function(A){WIKIDOT.Editor.currentPos=WIKIDOT.Editor.ranger.getSelectionRange()[0];var B=new OZONE.dialogs.Dialog();B.style.width="70%";B.title=ogettext("Image wizard");B.buttons=["cancel","insert code"];B.addButtonListener("cancel",B.close);B.addButtonListener("insert code",WIKIDOT.Editor.imageWizard.insertCode);B.content=$("wd-ed-imagewizard-dialog").innerHTML.replace(/\-template/g,"");B.show();WIKIDOT.Editor.imageWizard.updateSourceBlock()},tableWizard:function(A){WIKIDOT.Editor.currentPos=WIKIDOT.Editor.ranger.getSelectionRange()[0];var B=new OZONE.dialogs.Dialog();B.title=ogettext("Table wizard");B.buttons=["cancel","insert code"];B.addButtonListener("cancel",B.close);B.addButtonListener("insert code",WIKIDOT.Editor.listeners.tableWizardInsert);B.content=$("wd-ed-tablewizard-dialog").innerHTML.replace(/\-template/g,"");B.show()},uriWizard:function(A){WIKIDOT.Editor.currentPos=WIKIDOT.Editor.ranger.getSelectionRange()[0];var B=new OZONE.dialogs.Dialog();B.title=ogettext("URL link wizard");B.buttons=["cancel","insert code"];B.addButtonListener("cancel",B.close);B.addButtonListener("insert code",WIKIDOT.Editor.listeners.uriWizardInsert);B.content=$("wd-ed-uriwizard-dialog").innerHTML.replace(/\-template/g,"");B.show()},pageLinkWizard:function(C){WIKIDOT.Editor.currentPos=WIKIDOT.Editor.ranger.getSelectionRange()[0];var D=new OZONE.dialogs.Dialog();D.title=ogettext("Page link wizard");D.buttons=["cancel","insert code"];D.addButtonListener("cancel",D.close);D.addButtonListener("insert code",WIKIDOT.Editor.listeners.pageLinkWizardInsert);D.content=$("wd-ed-pagelinkwizard-dialog").innerHTML.replace(/\-template/g,"");D.show();var A=new YAHOO.util.XHRDataSource("/quickmodule.php");A.responseType=YAHOO.util.XHRDataSource.TYPE_JSON;A.responseSchema={resultsList:"pages",fields:["unix_name","title"]};var B=new YAHOO.widget.AutoComplete("wd-ed-pagelinkwizard-page","autocomplete3432",A);B.generateRequest=function(E){return"?s="+WIKIREQUEST.info.siteId+"&module=PageLookupQModule&q="+E};B.formatResult=function(E,H){var G=E[1];var F=E[0];if(F!=null){return"<div >"+F+'</div><div style="font-size: 85%;">('+G+")</div>"}else{return""}};B.minQueryLength=2;B.queryDelay=0.5;B.forceSelection=false;B.autoHighlight=false},codeWizard:function(A){WIKIDOT.Editor.currentPos=WIKIDOT.Editor.ranger.getSelectionRange()[0];var B=new OZONE.dialogs.Dialog();B.title=ogettext("Code block wizard");B.buttons=["cancel","insert code"];B.addButtonListener("cancel",B.close);B.addButtonListener("insert code",WIKIDOT.Editor.listeners.codeWizardInsert);B.content=$("wd-ed-codewizard-dialog").innerHTML.replace(/\-template/g,"");B.show()},erefWizard:function(C){WIKIDOT.Editor.currentPos=WIKIDOT.Editor.ranger.getSelectionRange()[0];var D=new OZONE.dialogs.Dialog();D.title=ogettext("Equation reference wizard");D.buttons=["cancel","insert code"];D.addButtonListener("cancel",D.close);D.addButtonListener("insert code",WIKIDOT.Editor.erefWizard.insertCode);D.content=$("wd-ed-erefwizard-dialog").innerHTML.replace(/\-template/g,"");D.show();var I=$(WIKIDOT.Editor.editElementId).value;var E=I.match(/^\[\[math\s([a-zA-Z0-9]+)\]\](\r?\n.*)*?\r?\n\[\[\/math\]\]/mg);if(E==null||E.length==0){var H=new OZONE.dialogs.ErrorDialog();H.content="Sorry, no labelled equations found.";H.show();return }var F="";if(E.length==0){F="no equations with labels available"}else{F='<select id="wd-ed-erefwizard-ref">';for(var A=0;A<E.length;A++){var G=E[A].replace(/\[\[math\s(.+?)\]\](\r*\n.*)*/,"$1");var B=E[A].replace(/\[\[math[^\]]*\]\]((?:\r?\n.*)*?)\n\[\[\/math\]\]/,"$1");$("wd-ed-erefwizard-preview").innerHTML+='<div id="wd-ed-erefwizard-preview-'+G+'">'+B+"</div>";F+='<option value="'+G+'">'+G+"</option>"}F+="</select>"}$("wd-ed-erefwizard-options").innerHTML=F;OZONE.dialog.factory.boxcontainer().centerContent();WIKIDOT.Editor.erefWizard.changeRef(null);YAHOO.util.Event.addListener("wd-ed-erefwizard-ref","change",WIKIDOT.Editor.erefWizard.changeRef)}};WIKIDOT.Editor.erefWizard={};WIKIDOT.Editor.erefWizard.changeRef=function(D){var C=$("wd-ed-erefwizard-preview");var A=C.childNodes;for(var B=0;B<A.length;B++){A[B].style.display="none"}$("wd-ed-erefwizard-preview-"+$("wd-ed-erefwizard-ref").value).style.display="block"};WIKIDOT.Editor.erefWizard.insertCode=function(C){var B=$("wd-ed-erefwizard-ref").value;var A="[[eref "+B+"]]";if($("wd-ed-erefwizart-weq").checked==true){A="Eq.("+A+")"}WIKIDOT.Editor.ranger.setSelectionRange(WIKIDOT.Editor.currentPos,WIKIDOT.Editor.currentPos);WIKIDOT.Editor.utils.insertText(A);OZONE.dialog.cleanAll()};WIKIDOT.Editor.imageWizard={};WIKIDOT.Editor.imageWizard.updateSourceBlock=function(B){var A;$("wd-ed-imagewizard-byuri").style.display="none";$("wd-ed-imagewizard-byfile").style.display="none";$("wd-ed-imagewizard-byflickr").style.display="none";$("wd-ed-imagewizard-checkresult").innerHTML="";if($("342type1").checked==true){A="uri";$("wd-ed-imagewizard-byuri").style.display="block"}else{if($("342type2").checked==true){A="file";$("wd-ed-imagewizard-byfile").style.display="block";WIKIDOT.Editor.imageWizard.updateAttachements()}else{if($("342type3").checked==true){A="flickr";$("wd-ed-imagewizard-byflickr").style.display="block"}}}WIKIDOT.Editor.imageWizard.source=A};WIKIDOT.Editor.imageWizard.updateAttachements=function(){OZONE.ajax.requestModule("editor/ImageAttachedFileModule",{pageId:WIKIREQUEST.info.pageId},WIKIDOT.Editor.imageWizard.updateAttachementsCallback)};WIKIDOT.Editor.imageWizard.updateAttachementsCallback=function(A){$("wd-ed-imagewizard-byfile-list").innerHTML=A.body;WIKIDOT.Editor.imageWizard.attachementSelect()};WIKIDOT.Editor.imageWizard.attachementSelect=function(C){var B=$("wd-ed-imagewizard-byfile-filename");if(B){var A=$("wd-ed-imagewizard-byfile-filename").value;var D="/local--resized-images/"+WIKIREQUEST.info.requestPageName+"/"+A+"/thumbnail.jpg";$("wd-ed-imagewizard-byfile-preview").src=D}};WIKIDOT.Editor.imageWizard.checkFlickrImage=function(E){p=new Object();var D=$("wd-ed-imagewizard-checkresult");var B=$("wd-ed-imagewizard-flickr").value;var C=B.replace(/^http:\/\/(?:www\.)?flickr\.com\/.*?\/([0-9]+)(?:\/.*)?$/,"$1");var A=null;if(B.match(/^http:\/\/static\.flickr\.com\/[0-9]+\/([0-9]+)_([0-9a-z]+).*$/)){C=B.replace(/^http:\/\/static\.flickr\.com\/[0-9]+\/([0-9]+)_([0-9a-z]+).*$/,"$1");A=B.replace(/^http:\/\/static\.flickr\.com\/[0-9]+\/([0-9]+)_([0-9a-z]+).*$/,"$2");p.secret=A}D.innerHTML="checking image "+C+"...";if(!C.match(/^([0-9]+)$/)){D.innerHTML='<p style="color: red">Not a valid input for the flickr.com image.</p>';return }p.flickr_id=C;OZONE.ajax.requestModule("editor/FlickrCheckModule",p,WIKIDOT.Editor.imageWizard.checkFlickrImageCallback)};WIKIDOT.Editor.imageWizard.checkFlickrImageCallback=function(B){var A=$("wd-ed-imagewizard-checkresult");A.innerHTML=B.body};WIKIDOT.Editor.imageWizard.checkUriImage=function(C){var A=$("wd-ed-imagewizard-uri").value;var D=window.open("about:blank","_blank","location=no,menubar=no,titlebar=no,resizable=yes,scrollbars=yes,width="+(screen.width*0.5)+",height="+(screen.height*0.5)+",top="+(screen.height*0.25)+",left="+(screen.width*0.25));D.document.write('<html><head><title>Checking image...</title></head><body><div style="text-align: center"><p>	If you see the image below - that means the location of the image you have entered is ok.</p>	<img id="check-image" src="'+A+'" alt="image not available!"/><p><a href="javascript:;" onclick="window.close()">close this window</a></p></div></body></html>');var B=D.document.getElementById("check-image");YAHOO.util.Event.addListener(B,"load",WIKIDOT.Editor.imageWizard.checkUriImageResize,D)};WIKIDOT.Editor.imageWizard.checkUriImageResize=function(E,D){var C=Math.min(this.width+200,screen.availWidth-100);var A=Math.min(this.height+200,screen.availHeight-100);var B=(screen.availWidth-C)*0.5;var F=(screen.availHeight-A)*0.5;D.resizeTo(C,A);D.moveTo(B,F)};WIKIDOT.Editor.imageWizard.insertCode=function(F){var H=WIKIDOT.Editor.imageWizard.source;var A;if(H=="uri"){A=$("wd-ed-imagewizard-uri").value}else{if(H=="file"){A=$("wd-ed-imagewizard-byfile-filename").value}else{if(H=="flickr"){var I=$("wd-ed-imagewizard-flickr").value;var J=I.replace(/^http:\/\/(?:www\.)?flickr\.com\/.*?\/([0-9]+)(?:\/.*)?$/,"$1");var D=null;if(I.match(/^http:\/\/static\.flickr\.com\/[0-9]+\/([0-9]+)_([0-9a-z]+).*$/)){J=I.replace(/^http:\/\/static\.flickr\.com\/[0-9]+\/([0-9]+)_([0-9a-z]+).*$/,"$1");D=I.replace(/^http:\/\/static\.flickr\.com\/[0-9]+\/([0-9]+)_([0-9a-z]+).*$/,"$2")}if(!J.match(/^([0-9]+)$/)){var G=$("wd-ed-imagewizard-checkresult");G.innerHTML='<p style="color: red">Not a valid input for the flickr.com image.</p>';return }A="flickr:"+J;if(D){A+="_"+D}}}}var K="";var C=$("wd-ed-imagewizard-size");if(C){K=C.value}if(K!=""){K=' size="'+K+'"'}var E=$("wd-ed-imagewizard-position").value.replace(/l/,"<").replace(/r/,">").replace(/c/,"=");var B="[["+E+"image "+A+K+"]]";WIKIDOT.Editor.ranger.setSelectionRange(WIKIDOT.Editor.currentPos,WIKIDOT.Editor.currentPos);WIKIDOT.Editor.utils.insertText(B);OZONE.dialog.cleanAll()};WIKIDOT.Editor.listeners={tableWizardInsert:function(F){var E=$("wd-ed-tablewizard-rows").value;var D=$("wd-ed-tablewizard-columns").value;var G=$("wd-ed-tablewizard-headers").checked;var B="";for(var C=0;C<E;C++){B+=INSERT_NEWLINE+"||";for(var A=0;A<D;A++){if(C==0&&G){B+="~ header ||"}else{B+=" cell-content ||"}}}WIKIDOT.Editor.ranger.setSelectionRange(WIKIDOT.Editor.currentPos,WIKIDOT.Editor.currentPos);WIKIDOT.Editor.utils.insertText(B,WIKIDOT.Editor.utils.endWithAtLeast1NewLine,WIKIDOT.Editor.utils.startWithAtLeast2NewLine);OZONE.dialog.cleanAll()},uriWizardInsert:function(D){var C=$("wd-ed-uriwizard-uri").value;var B=$("wd-ed-uriwizard-anchor").value;var E=$("wd-ed-uriwizard-newwindow").checked;var A="";if(B==null||B==""){if(E){A+="*"}A+=C}else{A="[";if(E){A+="*"}A+=C+" "+B+"]"}WIKIDOT.Editor.ranger.setSelectionRange(WIKIDOT.Editor.currentPos,WIKIDOT.Editor.currentPos);WIKIDOT.Editor.utils.insertText(A);OZONE.dialog.cleanAll()},pageLinkWizardInsert:function(D){var A=$("wd-ed-pagelinkwizard-page").value;var C=$("wd-ed-pagelinkwizard-anchor").value;var B="[[["+A;if(C!=null&&C!=""){B+=" |"+C}B+="]]]";WIKIDOT.Editor.ranger.setSelectionRange(WIKIDOT.Editor.currentPos,WIKIDOT.Editor.currentPos);WIKIDOT.Editor.utils.insertText(B);OZONE.dialog.cleanAll()},codeWizardInsert:function(D){var C=$("wd-ed-codewizard-type").value;var B="[[code";if(C!=""){B+=' type="'+C+'"'}B+="]]"+INSERT_NEWLINE;var A=INSERT_NEWLINE+"[[/code]]";WIKIDOT.Editor.ranger.setSelectionRange(WIKIDOT.Editor.currentPos,WIKIDOT.Editor.currentPos);WIKIDOT.Editor.utils.insertTags(B,A,"insert the code here",WIKIDOT.Editor.utils.trimSelection,WIKIDOT.Editor.utils.endWithAtLeast2NewLine,WIKIDOT.Editor.utils.startWithAtLeast2NewLine);OZONE.dialog.cleanAll()}};WIKIDOT.Editor.keyboardListener=function(D){WIKIDOT.Editor.lastKeyCode=null;var C=YAHOO.util.Event.getCharCode(D);WIKIDOT.Editor.lastKeyCode=C;var A="";if(D.ctrlKey==true){A+="ctrl+"}if(D.altKey==true){A+="alt+"}A+=String.fromCharCode(C);if($("editdebug")){$("editdebug").innerHTML=C}var B=WIKIDOT.Editor.keys[A];if(!B){B=WIKIDOT.Editor.keyCodes[C]}if(B){YAHOO.util.Event.preventDefault(D);B.call(null,D)}};WIKIDOT.Editor.codeAssist={};WIKIDOT.Editor.codeAssist.listener=function(B){var A=WIKIDOT.Editor.lastKeyCode;if(A!=13){return }WIKIDOT.Editor.utils.insertText("",WIKIDOT.Editor.codeAssist.rules.listEnd);WIKIDOT.Editor.utils.insertText("",WIKIDOT.Editor.codeAssist.rules.list);WIKIDOT.Editor.utils.insertText("",WIKIDOT.Editor.codeAssist.rules.listNested);WIKIDOT.Editor.codeAssist.rules.completeBlock();WIKIDOT.Editor.utils.insertText("",WIKIDOT.Editor.codeAssist.rules.definitionList);WIKIDOT.Editor.utils.insertText("",WIKIDOT.Editor.codeAssist.rules.keepIndent);WIKIDOT.Editor.utils.insertText("",WIKIDOT.Editor.codeAssist.rules.indentEnd)};WIKIDOT.Editor.codeAssist.rules={};WIKIDOT.Editor.codeAssist.rules.list=function(A){A=A.replace(/(\r?\n([\*#])\s.*?\r?\n)$/,"$1$2 ");return A};WIKIDOT.Editor.codeAssist.rules.definitionList=function(A){A=A.replace(/(\r?\n:\s.+?\s:.*\r?\n)$/,"$1: ");return A};WIKIDOT.Editor.codeAssist.rules.listNested=function(A){A=A.replace(/(\r?\n *[\*#]\s.+\r?\n( *)([\*#])\s.*?\r?\n)$/,"$1$2$3 ");return A};WIKIDOT.Editor.codeAssist.rules.listEnd=function(A){A=A.replace(/(\r?\n\s*[\*#:]\s.*?\r?\n)\s*[\*#:]\s\r?\n$/,"$1"+INSERT_NEWLINE);return A};WIKIDOT.Editor.codeAssist.rules.keepIndent=function(A){A=A.replace(/(\r?\n(\t+).+\r?\n)$/,"$1$2");return A};WIKIDOT.Editor.codeAssist.rules.indentEnd=function(A){A=A.replace(/(\r?\n(\t+)\r?\n)$/,INSERT_NEWLINE+INSERT_NEWLINE);return A};WIKIDOT.Editor.codeAssist.rules.completeBlock=function(){var F=$(WIKIDOT.Editor.editElementId);var E=F.scrollTop;var B=WIKIDOT.Editor.ranger;var A=B.getSelectionRange();var D=F.value.substring(0,A[1]);var G=F.value.substring(A[1],F.value.length);var C=D.length;D=D.replace(/(\[\[(code|embedvideo|math|embed)(?:\s[^\]]*?)?\]\]\r?\n)$/,"$1"+INSERT_NEWLINE+"[[/$2]]");F.value=D+G;var H=C;B.setSelectionRange(H,H);F.scrollTop=E};WIKIDOT.Editor.codeAssist.rules.completeBlockPost=function(A){};WIKIDOT.Editor.keys=new Object();WIKIDOT.Editor.keys["ctrl+b"]=WIKIDOT.Editor.buttons.bold;WIKIDOT.Editor.keys["ctrl+i"]=WIKIDOT.Editor.buttons.italic;WIKIDOT.Editor.keys["ctrl+u"]=WIKIDOT.Editor.buttons.underline;WIKIDOT.Editor.keyCodes=new Object();WIKIDOT.Editor.keyCodes[9]=function(A){WIKIDOT.Editor.utils.insertText("\t");YAHOO.util.Event.stopEvent(A)};WIKIDOT.Editor.utils={};WIKIDOT.Editor.utils.insertTags=function(F,L,D,O,K,A,P){var N=$(WIKIDOT.Editor.editElementId);N.focus();var C=WIKIDOT.Editor.ranger;C.trimSelection();var J=C.getSelectionRange();var E=N.scrollTop;var I=N.value.substring(0,J[0]);if(K){I=K.call(null,I)}var Q=N.value.substring(J[1],N.value.length);if(A){Q=A.call(null,Q)}if(J[0]!=J[1]){var G=N.value.substring(J[0],J[1]);if(O){G=O.call(null,G)}N.value=I+F+G+L+Q;var H=N.value.length-Q.length;C.setSelectionRange(H,H)}else{N.value=I+F+D+L+Q;if(!P){var M=I.length+F.length;var B=M+D.length;C.setSelectionRange(M,B)}else{var H=N.value.length-Q.length;C.setSelectionRange(H,H)}}N.focus();N.scrollTop=E};WIKIDOT.Editor.utils.insertText=function(J,F,A){WIKIDOT.Editor.utils.insertTags("","",J,null,F,A,true);return ;var H=$(WIKIDOT.Editor.editElementId);var B=WIKIDOT.Editor.ranger;var G=B.getSelectionRange();var C=H.scrollTop;var E=H.value.substring(0,G[0]);if(F){E=F.call(null,E)}var I=H.value.substring(G[1],H.value.length);if(A){I=A.call(null,I)}H.value=E+J+I;var D=E.length;B.setSelectionRange(D,D);H.focus();H.scrollTop=C};WIKIDOT.Editor.utils.trimSelection=function(A){return A.replace(/^\s+/,"").replace(/\s+$/,"")};WIKIDOT.Editor.utils.endWithNewLine=function(A){return A.replace(/[\s\r\n]+$/,"")+INSERT_NEWLINE};WIKIDOT.Editor.utils.endWithAtLeast1NewLine=function(A){return A.replace(/\r?\n$/,"")+INSERT_NEWLINE};WIKIDOT.Editor.utils.startWithNewLine=function(A){return INSERT_NEWLINE+A.replace(/^[\s\r\n]+/,"")};WIKIDOT.Editor.utils.startWithAtLeast1NewLine=function(A){if(A.length==0){return A}return INSERT_NEWLINE+A.replace(/^\r?\n/,"")};WIKIDOT.Editor.utils.startWithAtLeast2NewLine=function(A){if(A.length==0){return A}return INSERT_NEWLINE+INSERT_NEWLINE+A.replace(/^\r?\n(\s*\r?\n)?/,"")};WIKIDOT.Editor.utils.endWithAtLeast2NewLine=function(A){if(A.length==0){return A}return A.replace(/(\r?\n\s*)?\r?\n$/,"")+INSERT_NEWLINE+INSERT_NEWLINE};WIKIDOT.Editor.utils.endWith2NewLine=function(A){if(A.length==0){return A}return A.replace(/[\s\r\n]+$/,"")+INSERT_NEWLINE+INSERT_NEWLINE};WIKIDOT.Editor.utils.startWith2NewLine=function(A){return INSERT_NEWLINE+INSERT_NEWLINE+A.replace(/^[\s\r\n]+/,"")};WIKIDOT.Editor.utils.processQuoteText=function(A){var A=A.replace(/^\s+/,"").replace(/\s+$/,"");A=A.replace(/\r?\n/g,INSERT_NEWLINE+"> ");return A};WIKIDOT.Editor.utils.processNumberedList=function(A){var A=A.replace(/^\s+/,"").replace(/\s+$/,"");A=A.replace(/\r?\n/g,INSERT_NEWLINE+"# ");return A};WIKIDOT.Editor.utils.processBulletedList=function(A){var A=A.replace(/^\s+/,"").replace(/\s+$/,"");A=A.replace(/\r?\n/g,INSERT_NEWLINE+"* ");return A};WIKIDOT.Editor.utils.increaseListIndent=function(A){if(A.match(/\r?\n(\s*)[\*#].*\r?\n(\1)\s+[\*#].*$/)){return A}return A.replace(/(\r?\n\s*[\*#].*)(\r?\n\s*)([\*#].*)$/,"$1$2 $3")};WIKIDOT.Editor.utils.decreaseListIndent=function(A){return A.replace(/(\r?\n\s*) ([\*#].*)$/,"$1$2")};TextElementProxyUtil=function(A,B){this.field=$(A);this.detectBrowser(B)};TextElementProxyUtil.prototype.detectBrowser=function(C){if(this.field.selectionStart||this.field.selectionStart==0){this.browserType="gecko"}else{var B,A;if(C){B=document.createElement("textarea");B.style.position="absolute";B.style.top="0";B.style.left="-1000px";A=document.getElementsByTagName("body").item(0);A.appendChild(B)}else{B=this.field}B.focus();if(document.selection.createRange){this.browserType="ie";INSERT_NEWLINE="\r\n"}if(C){A.removeChild(B)}}};TextElementProxyUtil.prototype.getCursorPosition=function(){var A=this.getSelectionRange();return A[1]};TextElementProxyUtil.prototype.getSelectionRange=function(){var C;var B;this.field.focus();if(this.browserType=="gecko"){C=this.field.selectionStart;B=this.field.selectionEnd}if(this.browserType=="ie"){if(document.selection){var A=document.selection.createRange();var D=A.duplicate();D.moveToElementText(this.field);D.setEndPoint("StartToStart",A);C=this.field.value.length-D.text.length;B=C+A.text.length}}if(this.browserType=="rest"){}this.field.focus();return[C,B]};TextElementProxyUtil.prototype.setSelectionRange=function(C,B){this.field.focus();if(this.browserType=="gecko"){this.field.setSelectionRange(C,B)}if(this.browserType=="ie"){var D=this.field.value.substring(0,C);var E=this.field.value.substring(C,B);C=D.replace(/\r\n/g,"\n").length;B=C+E.replace(/\r\n/g,"\n").length;var A=this.field.createTextRange();A.collapse(true);A.moveEnd("character",B);A.moveStart("character",C);A.select()}if(this.browserType=="rest"){}this.field.focus()};TextElementProxyUtil.prototype.trimSelection=function(){var B=this.getSelectionRange();var D=this.field.value.substring(B[0],B[1]);var C=D.length-D.replace(/^\s+/,"").length;var A=D.length-D.replace(/\s+$/,"").length;this.setSelectionRange(B[0]+C,B[1]-A)};